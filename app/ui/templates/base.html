<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="csrf-token" content="{{ csrf_token }}" />
  <title>CB Organizer</title>
  <script src="https://unpkg.com/htmx.org@1.9.12"></script>
  <script src="https://unpkg.com/react@18/umd/react.production.min.js" crossorigin="anonymous" defer></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js" crossorigin="anonymous" defer></script>
  <script src="https://unpkg.com/framer-motion@11.3.19/dist/framer-motion.js" crossorigin="anonymous" defer></script>
  <script src="/static/csrf.js?v=cat-tree-70" defer></script>
  <script src="/static/duo_cat_mount.js?v=cat-tree-75" defer></script>
  <script src="/static/hanging_tags.js?v=cat-tree-73" defer></script>
  <link rel="stylesheet" href="/static/styles.css?v=cat-tree-95" />
  <style>
    /* Fallback to ensure vertical left nav even if an older cached stylesheet is still applied. */
    body.app-shell { display: grid !important; grid-template-columns: minmax(260px, 26vw) 1fr !important; align-items: start !important; }
    .left-tree.exact-tree { min-height: 100vh !important; border-right: 0 !important; }
    .tree-nav.exact-tree-nav { display: block !important; }
    .tree-tab.tree-hotspot { display: flex !important; align-items: center !important; justify-content: center !important; }
    .content-shell { margin: 0 !important; max-width: none !important; padding: 24px 20px 30px !important; }
  </style>
</head>
{% set current_path = request.url.path %}
{% set nav_state = 0 %}
{% set active_tab = "dashboard" %}
{% set show_duo_badge = not current_path.startswith("/dev/cats/duo") %}
{% if current_path.startswith("/providers") %}
  {% set nav_state = 1 %}
  {% set active_tab = "providers" %}
{% elif current_path.startswith("/policies") %}
  {% set nav_state = 2 %}
  {% set active_tab = "policies" %}
{% elif current_path.startswith("/expenses") %}
  {% set nav_state = 3 %}
  {% set active_tab = "expenses" %}
{% endif %}
<body class="app-shell cat-state-{{ nav_state }}">
<aside class="left-tree exact-tree">
  <div class="tree-scene">
    <h1 class="tree-title visually-hidden">CB Organizer</h1>
    <p class="tree-subtitle visually-hidden">Cat Tree Navigation</p>
    <nav class="tree-nav exact-tree-nav" aria-label="Primary">
      <img src="/static/FloralCatTreeDirectory_tight.png" class="exact-tree-art" alt="" aria-hidden="true" />
      <div class="tree-grid-overlay" aria-hidden="true">
        <div class="tree-grid-labels tree-grid-labels-x">
          <span style="left: 0%;">0</span>
          <span style="left: 10%;">10</span>
          <span style="left: 20%;">20</span>
          <span style="left: 30%;">30</span>
          <span style="left: 40%;">40</span>
          <span style="left: 50%;">50</span>
          <span style="left: 60%;">60</span>
          <span style="left: 70%;">70</span>
          <span style="left: 80%;">80</span>
          <span style="left: 90%;">90</span>
          <span style="left: 100%;">100</span>
        </div>
        <div class="tree-grid-labels tree-grid-labels-y">
          <span style="top: 0%;">0</span>
          <span style="top: 10%;">10</span>
          <span style="top: 20%;">20</span>
          <span style="top: 30%;">30</span>
          <span style="top: 40%;">40</span>
          <span style="top: 50%;">50</span>
          <span style="top: 60%;">60</span>
          <span style="top: 70%;">70</span>
          <span style="top: 80%;">80</span>
          <span style="top: 90%;">90</span>
          <span style="top: 100%;">100</span>
        </div>
      </div>
      <a class="tree-tab tree-hotspot hotspot-dashboard{% if active_tab == 'dashboard' %} active active-shelf{% endif %}" href="/" data-state="0">
        <span class="hotspot-string" aria-hidden="true"></span>
        <span class="hotspot-label">Dashboard</span>
        {% if show_duo_badge and active_tab == 'dashboard' %}
          {% include "partials/cat_duo_badge.html" %}
        {% endif %}
      </a>

      <a class="tree-tab tree-hotspot hotspot-providers{% if active_tab == 'providers' %} active active-shelf{% endif %}" href="/providers" data-state="1">
        <span class="hotspot-string" aria-hidden="true"></span>
        <span class="hotspot-label">Providers</span>
        {% if show_duo_badge and active_tab == 'providers' %}
          {% include "partials/cat_duo_badge.html" %}
        {% endif %}
      </a>

      <a class="tree-tab tree-hotspot hotspot-policies{% if active_tab == 'policies' %} active active-shelf{% endif %}" href="/policies" data-state="2">
        <span class="hotspot-string" aria-hidden="true"></span>
        <span class="hotspot-label">Policies</span>
        {% if show_duo_badge and active_tab == 'policies' %}
          {% include "partials/cat_duo_badge.html" %}
        {% endif %}
      </a>

      <a class="tree-tab tree-hotspot hotspot-expenses{% if active_tab == 'expenses' %} active active-shelf{% endif %}" href="/expenses" data-state="3">
        <span class="hotspot-string" aria-hidden="true"></span>
        <span class="hotspot-label">Expenses</span>
        {% if show_duo_badge and active_tab == 'expenses' %}
          {% include "partials/cat_duo_badge.html" %}
        {% endif %}
      </a>

      <form method="post" action="/auth/logout" class="tree-hotspot-form">
        <input type="hidden" name="csrf_token" value="{{ csrf_token }}" />
        <button type="submit" class="tree-tab tree-hotspot hotspot-lock tree-lock" aria-label="Lock app">
          <span class="visually-hidden">Lock app</span>
        </button>
      </form>
    </nav>

  </div>
</aside>
<main class="content-shell">
  {% block content %}{% endblock %}
</main>
</body>
</html>
